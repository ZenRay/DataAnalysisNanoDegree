**目录**

[toc]

	 
# 1. 试验设计
试验设计的方向是**免费试学筛选器**。设计的过程是在进行此试验时，优达学城当前的主页上有两个选项:“开始免费试学”和“访问课程资料”。 如果学生点击“开始免费试学”，系统将要求他们输入信用卡信息，然后他们将进入付费课 程版本的免费试学。14 天后，将对他们自动收费，除非他们在此期限结束前取消试用。若 学生点击“访问课程材料”，他们将能够观看视频和免费进行小测试，但是他们不会获得导 师指导支持或验证证书，无法提交最终项目来获取反馈。

在此试验中，优达学城测试了一项变化，如果学生点击“开始免费试学”，系统会问他们有 多少时间投入到这个课程中。如果学生表示每周 5 小时或更多，将按常规程序进行登录。 如果他们表示一周不到 5 小时，将出现一条消息说明优达学城的课程通常需要更多的时间 投入才能成功完成，并建议学生可免费访问课程资料。在这里，学生可选择继续进行免费试 学，或免费访问课程资料。

**试验假设**是变更会为学生预先设定明确的期望，从而**减少**因为没有足够的时间而离开免费试学，并因此**受挫的学生数量**，同时不会在很大程度上**减少**继续通过**免费试学**和**最终完成课程的学生数量**。如果这个假设最后为真，优达学城将改进整体学生体验和提高导师为能够完成 课程的学生提供支持的能力。

## 1.1 指标选择
在本次项目中，可供选择的指标包括：

- Cookie 的数量：即查看课程概述页面的唯一 cookie 的数量
- 用户 id 的数量：即报名参加免费试用的用户数量
- 点击次数：即点击“开始免费试用”按钮（在免费试用屏幕触犯前发生）的唯一 cookie 的数量
- 点进概率：即点击“开始免费试用”按钮的唯一 cookie 除以查看课程概述页面的唯一 cookie 的数量所得的结果
- 总转化率：即完成登录并报名参加免费试用的用户 id 的数量除以点击“开始免费试用”按钮的唯一 cookie 的数量所得的结果
- 留存率：即在 14 天期限后仍保持参加（并进行了至少一次支付）的用户 id 的数量除以完成登录的用户 id 的数量
- 净转化率：即在 14 天期限结束后仍然参加（并至少进行了一次支付）的用户 id 的数量除以点击“开始免费试用”按钮的唯一 cookie 的数量所得的结果

从以上指标中筛选出**不变指标**和**评估指标**，筛选出的指标和依据如下：

<ol type="i">
	<li><b>不变指标</b></li>
	<ul>
		<li>Cookie 的数量</li>
		<p>依据和期望：Cookie 是本试验中一个重要的分流依据，因此 Cookie 不变是保障试验过程随机性的重要基础，因此在试验中期望其保持<b>不变</b></p>
		<li>点击次数</li>
		<p>依据和期望：从试验设计的假设来看，变更的内容并没有针对点击项。因为 Cookie 的数量不变，“开始免费试用”触发前的点击次数在试验中也是期望获得<b>不变值</b></p>
		<li>点进概率</li>
		<p>依据和期望：根据点进概率的计算公式，其值与点击次数及浏览 Cookie 数量有关。而两者的期望或者试验设计就是作为不变指标，因此该值也是<b>不变化的</b></p>
	</ul>
	
	<li><b>评估指标</b></li>
	<ul>
		<li>总转化率</li>
		<p>依据和期望：根据试验中的假设之一是避免减少通过免费试学和最终完成课程的学生数量，即要确认转化率实际变化情况。从实际的情况来看，因为提醒了课程规划时间导致登陆注册用户数量降低，而假设的总体的 Cookie 数量不会变化，即可能导致期望的总转化率<b>降低</b></p>
		<li>留存率</li>
		<p>依据和期望：由课程时间规划提醒的变更，可能导致登陆注册的用户数量降低，同时登陆付费继续学习的用户数量增加，期望可能引起留存率的<b>增加</b>；同时在试验假设之一中剔除部分受挫用户，提高登陆注册的用户质量</p>
		<li>净转化率</li>
		<p>依据和期望：同样在变更中引起的会对登陆注册的用户数量产生影响，而 Cookie 数量是没有不变。因此可能导致净转化率发生变化，然而根据试验假设避免登陆注册用户数量的减少，因此期望是在试验中获得<b>不变的</b>净转化率</p>
	</ul>
	<li><b>非相关指标</b></li>
	<ul>
		<li>用户 ID 数量</li>
		<p>依据：首先课试验假设中，变更主要针对的是新注册用户，该指标的结果变化体现在试验之后，可以作为一个良好的评估度量指标；另一方面，试验组和对照组中以 Cookie 作为分流一句，但是用户 ID 在两个群组中数量存在较大的差异，因此不适合单独使用该指标作为评估试验效果的标准。同时在试验初期，选用总转化率作为评估指标，因此不使用用户 ID 作为试验的评估指标。综合以上两点，把用户 ID 数量作为本次试验的非相关指标</p>	
	</ul>
</ol>

## 1.2 测量标准偏差
试验过程是一个二项分布，并且使用的评估指标为：总转化率、留存率和净转化率。根据二项是计算标准偏差的公式： $SD\ =\ {\sqrt{\frac{p\ *\ (1\ -\ p)}{N}}}$ ，分别对以上三项计算标准偏差，另外参照的信息见[基准值表](https://s3.cn-north-1.amazonaws.com.cn/static-documents/nd002/Final+Project+Baseline+Values.xlsx)。

<ol type="i">
	<li>总转化率标准偏差以及分析估计和经验变异关系</li>
	<p>总 Cookie 数量为 <code>5000</code>，“免费试用按钮”的点进率是 <code>0.08</code>，那么点进用户的数量 N 为 <code>5000 * 0.08 = 400</code>；同时给定的转化率为 <code>0.20625</code>。计算出<b>标准偏差</b> <code>0.0202</code></p>
	<p>关于分析估计和经验变异的关系，主要的依据是 <code>unit of analysis = unit of diversion</code> 即分析单元 = 分流单元。因为总转化率中分析单元和分流单元都是以 Cookie 数量来计量，所以在总转化率中的分析估计和经验变异的关系是<b>相似的</b> </p>
	
	<li>留存率标准偏差以及分析估计和经验变异关系</li>
	<p>点进用户数量为 <code>400</code>， 另外给定的总转化率 <code>0.20625</code>，那么完成登录的用户数量为 <code>400 * 0.20625 = 82.5</code>，给定的留存率为 <code>0.53</code>。计算出<b>标准偏差</b>为 <code>0.0549</code>。</p>
	<p>留存率中分析单元是以用户 ID 数量来计量，而分流单元都是以 Cookie 数量来计量，两者的计量不同，所以在留存率中的分析估计和经验变异的关系是<b>不同的</b></p>
	<p><b>注意：</b>因为留存率低分析估计经验变异关系不同，同时因为从计算公式可知，在计算留存率中使用了用户 ID 作为分母参与计算。综合以上两点，后续过程中不再使用留存率作为评估指标</p>
	<li>净转化率标准偏差以及分析估计和经验变异关系</li>
	<p>点进用户的数量为 <code>400</code>，给定的净转化率为 <code>0.1093125</code>。计算出<b>标准偏差</b>为 <code>0.0156</code>。</p>
	<p>净转化率中分析单元和分流单元都是以 Cookie 数量来计量，所以在净转化率中的分析估计和经验变异的关系是<b>相似的</b> 
</ol>

## 1.3 规模
试验规模利用[在线计算器](http://www.evanmiller.org/ab-testing/sample-size.html)计算出需要的试验规模。详细的计算流程如下：

<ol type="i">
	<li>总转化率规模</li>
	<p>根据项目指导中给定的 Minimum Detectable Effect 为 <code>0.01</code>，而 baseline value 文件中给定的 Baseline conversion rate 为 <code>0.20625</code>，计算出总转化率的样本容量为 <code>25,835</code>。利用样本容量和给定的点进率 <code>0.08</code>，计算出需要试验组的 Cookie 总体数量为 <code>25,835 / 0.08 = 322,938</code> </p>
	<li>净转化率规模</li>
	<p>根据项目指导中给定的 Minimum Detectable Effect 为 <code>0.0075</code>，而 baseline value 文件中给定的 Baseline conversion rate 为 <code>0.1093125</code>，计算出净转化率的样本容量为 <code>27,413</code>。利用样本容量和给定的点进率 <code>0.08</code>，计算出需要试验组的 Cookie 总体数量为 <code>27,413 / 0.08 = 342,663</code> </p>
	<li>留存率规模</li>
	<p>根据项目中指导给定的 Minimum Detectable Effect 为<code>0.01</code>，而 baseline value 文件中给定的 Baseline cinversion rate 为 <code>0.53</code>，计算出留存率低样本容量为 <code>39,115</code>。利用得到的样本容量和给定的留存率为<code>0.08</code>，计算出试验组需要的总体样本量为 <code>39,115 / 0.08 = 488,938</code></p>
</ol>

利用以上三者计算出的试验组的样本容量最大值为 `488,938`，然而选择的评估指标中，因为留存率低分析估计经验变异关系不同且在三者中需要的样本容量偏大、会导致试验时间过长，综合考虑不再使用留存率作为评估指标，因此也不使用留存率的试验规模作为试验的样本规模的参考。

那么综合总转化率和净转化率两者的试验规模考虑，需要的试验规模为 `342,663`，而在试验对照组和试验组保证随机性和正确性需要对试验组容量加倍 `342663 * 2 = 685,325`，即试验中使用的**总体规模**为`685,325`。

对于使用 Bonferroni 校正，因为总转化率和净转化率是具有**相关性**的。如果使用矫正那么可能导致分析过于保守，因此在分析过程中**不使用 Bonferroni 校正**。

关于试验选择的持续时间和曝光比例，根据以下条件进行分析：

* 用户的学习时间方面来看，变更主要是一个提醒作用，并没有从本质上改变用户的学习习惯
* 该变更对网页内容不是很突出，对用户来说不容易有偏好或者厌恶的情绪。因此用户对变更不需要太多时间去适应
* 变更的内容不涉及后端数据库等方面内容，同时对内容加载速度方面不太可能产生太大影响
* 同时在不涉及伦理问题和数据安全问题

综合上述理由，建议试验选择在尽快周期内完成，那么参考的**分流比例**为 **1**。同时基于给定的每天网页浏览总量为 `40,000`，同时计划的试验总体规模在 `685,325`，计算出可能需要的试验天数为 `685,325 / 40,000 = 17.13`，为了保障试验数据的充足——选择的**试验周期**为 **18** 天

# 2. 试验分析
## 2.1 合理性检查
根据试验指导不变指标进行合理性检查以及[获取到的数据](https://s3.cn-north-1.amazonaws.com.cn/static-documents/nd002/Final+Project+Results.xlsx)，设定 ${\alpha}$ 的值为 5% 分析 Cookie 数量、点击次数和点进概率的置信区间以及期望值。分析如下：

* Cookie 数量的合理性检查

	>试验组的 Cookie 数量为 `344,660`；而控制组的 Cookie 数量为 `345,543`。根据 SE 和 margin 的公式——${SE\ =\ \sqrt{\frac{p\ *\ (1\ -\ p)}{N_{cont}\ +\ N_{exp}}}}$ 和 ${margin\ =\ SE\ *\ z}$。其中**观测值**为 `0.5006`，而根据试验假设 Cookie 应该是随机平均分配，因此期望值 p 为 `0.5`
	
	>根据以上公式计算出的 SE 值为 `0.0006018`， margin 值为 `0.0006018 * 1.96 = 0.0011796`；因此在 95% 的条件下**置信区间**为 `[0.4988, 0.5012]`，而计算获得的观测值为 `0.5006` 满足该置信区间范围，因此 Cookie 数量的**合理性检查通过**

* 点击次数的合理性检查

	>试验组中点击次数为 `28,325`，而对照组中点击次数为 `28,378`，**观测值**为 `0.5005`。根据以上的计算公式，p 值为 `0.5`，SE 值为 `0.0021`，margin 值为 `0.0041`，因此 95% 条件下的**置信区间** 为 `[0.4959, 0.5041]`，观测值在置信区间范围内，因此点击次数的**合理性检查通过**

* 点进概率的合理性检查

	>在对照组中点进概率 p 值为 `0.08215814`，样本容量为 `345,543`。以此计算出 SE 值为 `0.000467068`，margin 值为 `0.000915454`，在 95% 条件下的**置信区间**为 `[0.0812, 0.0830]`，试验组中的点进概率**观测值**为 `0.0822`，该观测值在置信区间内，因此点进概率的**合理性检查通过**
	
## 2.2 结果分析
### 2.2.1 效应大小检验
对于每个评估指标，对试验和对照组之间的差异给出 95% 置信区间。说明每个指标是否具有统计和实际显著性。利用统计学公式进行分析 ${\hat{p}_{pool}=\frac{x_{cont}\ +\ x_{exp}}{N_{cont}\ +\ N_{exp}}}$ 、${SE_{pool}}=\sqrt{\hat{p}_{pool}\ *\ (1\ -\ \hat{p}_{pool})\ *\ (\frac{1}{N_{cont}}\ +\ \frac{1}{N_{exp}})}$ 以及 ${\hat{d}\ =\ \hat{p_{exp}}\ -\ \hat{p_{cont}}}$。

* 总转化率的效应大小检验

	>控制组中总转化率 ${\hat{p_{cont}}}$ 的计算方式是登录数除以点击数，其值为`0.218874689`，试验组中总转化率 ${\hat{p_{exp}}}$ 为 `0.198319815`；而两者的合并概率 ${\hat{p_{pool}}}$ 为 `0.208607067`，计算得到的 ${SE_{pool}}$ 值为 `0.004371675`，另外 ${\hat{d}}$ 值为 `-0.020554875`
	
	>在 95% 条件下得到的 margin 值为 `0.008568484`，因此得到的置信区间为 `[-0.0291, -0.0120]` 。在置信区间范围内不包括 0 值，因此具有**统计显著性**；同时设定的 ${d_{min}}$ 值为 0.01，也没有在置信区间内，因此具有**实际显著性**

* 净转化率的效应大小检验

	>控制组中净转化率 ${\hat{p_{cont}}}$ 的计算方式是付款书除以点击次数，其值为`0.117562019`，试验组中总转化率 ${\hat{p_{exp}}}$ 为 `0.112688297`；而两者的合并概率 ${\hat{p_{pool}}}$ 为 `0.115127485`，计算得到的 ${SE_{pool}}$ 值为 `0.003434134`，另外 ${\hat{d}}$ 值为 `-0.004873723`
	
	>在 95% 条件下得到的 margin 值为 `0.006730902`，因此得到的置信区间为 `[-0.0116, 0.0019]` 。在置信区间范围内包括 0 值，因此具有**统计不显著性**；同时设定的 ${d_{min}}$ 值为 0.0075，未在置信区间内，但是${-d_{min}}$ 值为 -0.0075，在置信区间内，同时因为无法通过统计显著性检验，因此具有**实际不显著性**

### 2.2.2 符号检验
对于每个评估指标，使用每日数据进行符号检验，然后报告符号检验的 p 值以及结果是否具有统计显著性。在进行符号检验时，利用[在线计算工具](http://graphpad.com/quickcalcs/binomial1.cfm)进行计算。

* 总转化率的符号检验

	>在试验中总共获得完整数据的次数为 `23` 次，而试验组优于对照组的次数为 `4` 次。尽心在线分析，选择双尾检验，同时根据二项式分布概率选择为 0.5，计算得到的结果 P value 为 `0.0026`，其值小于双尾检验中临界 P 值—— `0.025`。因此总转化率低符号检验**能提供显著性支持**

* 净转化率低符号检验

	>在试验中总共获得完整数据的次数为 `23` 次，而试验组优于对照组的次数为 `10` 次。尽心在线分析，选择双尾检验，同时根据二项式分布概率选择为 0.5，计算得到的结果 P value 为 `0.6776`，其值远大于双尾检验中临界 P 值——`0.025`。因此总转化率低符号检验**不能提供显著性支持**

### 2.2.3 汇总说明
在本次试验的分析过程中**不使用 Bonferroni 矫正**，因为以上两者具有相关性，如果使用矫正那么将导致分析过于保守

# 3. 建议
从获得的试验结果来看：虽然总转化率满足试验期初的设计，即减小总转化率；但是净转化率方面其 95% 的置信区间为 `[-0.0116，0.0019]`，包含了负数，因此存在净转化率降低的可能性。然而在试验初期的假设中，期望是获得净转化率不变，获得的结果和预期假设不相符。综合分析的结果来看，**建议暂时不要实施变更**。

# 4. 后续试验
从试验最初的假设来看，期望是能够提高用户转化率。因此建议对由已经完成点进用户到注册的用户的角度进行分析，假设提醒注册用户同批次的学习进度和改用户占地比例，以促进用户学习积极性、课程完成率。试验后续相关过程报告如下：

* 不变指标：
	* 注册用户 ID

	>因为此时是需要针对已经注册用户进行分析，所以选用注册用户 ID 作为不变指标和分流依据
	
* 评估指标：
	* 日活跃用户数量
	
	>统计变更后一日之内，登录或使用过某个应用的用户数（独立的用户）
	
	* 课程完成率

	>统计变更带来的用户的完成课程的比例
	
* 风险

>在试验中可能有用户对提醒存在厌恶，对此需要一个控制。因为注册用户的相关信息已经存在后台数据库中，不存在伦理和安全风险	
